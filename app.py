# coding:utf-8
import json
from flask import Flask, jsonify, make_response, request, Response
from requests_oauthlib import OAuth1Session
from twitter import Twitter, OAuth
from janome.tokenizer import Tokenizer
import collections
import re
from collections import Counter, defaultdict
import collections
import sys
import japanese_plaintext
import core
import emoji
import collections as cl


CONSUMER_KEY =  'YOURS'
CONSUMER_SECRET = 'YOURS'
ACCESS_TOKEN = 'YOURS'
ACCESS_SECRET = 'YOURS'

twitter = OAuth1Session(CONSUMER_KEY, CONSUMER_SECRET, ACCESS_TOKEN, ACCESS_SECRET)
url = "https://api.twitter.com/1.1/search/tweets.json"

app = Flask(__name__)
app.config['JSON_AS_ASCII'] = False

ignore_words = ['‰ªäÊó•','Êó•Êú¨','Êú¨Êó•','üíï\u3000','üëãüòÜ‚ú®‚òÄÔ∏è','Êò®Êó•','„Éª„Éª„Éª','Êó•Êú¨‰∫∫','„ÉÅ„Éß„É≠','u3000','ÔΩû¬¥‚àáÔΩÄÔæâ','Êó•Êú¨ÂõΩÊ∞ë','‰∫ãÁÑ°','ÊØéÊó•','‰∏ÄÊùæ','ÊôÇÈñì','‰∏≠ÂõΩ','ÔΩû‚ô™','Â§ß‰∫ã','‰ªäÂπ¥','Èò™Á•û','Âπ¥ÊúàÊó•', 'Êú¨ÂΩì','ÂÖÉÊ∞ó','ÂèØÊÑõ','ÊùæÂÖÑ','‰ªï‰∫ã',
    'ÂÜôÁúü','Êú¨Ê∞óÂá∫','\u3000Êó•Êú¨‰∫∫','ÈüìÂõΩ','ÊúÄÂæå','„Éª„Éª„Éª‰ªäÊó•','Â•≥ÊÄß','Âπ¥Ââç','ÔΩû‰ªäÊó•','üëãüòÉ‚òÄÔ∏è','Ëá™ÂàÜ','ÊòéÊó•','Êú¨Êó•ÊôÇ','Á∑öÈñãÊ•≠Âë®Âπ¥','\u3000„Éª',
 '‰∏ÄÊó•','„Éª„Éª„Éª„Éª„Éª','Êú¨Êó•ÂàÜ','Àä·µïÀã','ÂÖ®Êñá','„Ç´„É©','Â§ß‰∫∫','Êó•Êú¨È£ü','‚Åæ‚Åæ','üëãüòÜ‚ú®‚òÄÔ∏è\u3000','\u3000ÊÄù','„Éà„Éâ','ÁäØ‰∫∫',
 'Â•≥Á•û„ÉÅ„Éß„É≠','ÈñãÊ•≠','È£ü‰∫ãÂà∏','Êú¨Âπ¥','ÂêçÊßò','Ê≤¢Â±±','Ê∞óÊåÅ','Â±±Êú¨','Êó•Êú¨ÈÖí','ÊäïÁ®ø','‚òÖ‰ªäÊó•','Áô∫Áîü','‰ªäÂ∫¶','ÂøúÊè¥','ÂèçÊó•','‰∏Ä‰Ωì',
 'ÔΩûÔΩûÔΩû','Êó•Êú¨ÈüìÂõΩ','Êó•Êú¨‰æµÁï•','ÂΩºÊ∞è','Êó•Êú¨Ë™û','Áî∑ÊÄß','ÔΩûÊØéÊó•','„Äú‚ô™','„Äú‚ô™‰ªäÊó•','Êó•Êú¨‰ª•Â§ñ','ÂÜÜÂàÜ','Â∞èÂ≠¶Áîü','Êó•ÁõÆ','ÈÖç‰ø°‰∏≠','ÊôÆÈÄö','Â•≥Â≠ê','Ë®ò‰∫ã','‚ô™Êò®Êó•','üòÜüíï‚ú®‰ªäÊó•','‰ªäÊó•ÂØåÂ±±','ÁÑ°ÁêÜ','Â≠ê‰æõ','ÂãïÁîª','ÔΩû¬¥‚àáÔΩÄÔæâ‰ªäÊó•','Âá∫‰ºö','‰∫∫Ê∞ó','ÈÖí‰ºö',
 'ÂΩìÁÑ∂','‰∏ÄÊò®Êó•','ÂçÅÂõõÊùæ','ÂØåÂ±±','ÂÖàÁîü','Êú¨Áâ©','ÈñãÂÇ¨‰∏≠','ÊÑèÂë≥','ÊØéÊó•„ÉÅ„É£„É¨„É≥„Ç∏','ÁæéÂë≥','ÂÖàÁîüÊßò','„Ç≥„É°„É≥„Éà','Êú¨Êñá','ÊòØÈùû','ÁîªÂÉè','Èò™Á•ûÈõªËªä','ÊßòÔΩûü§ó‰ªäÊó•','ÊúÄÈ´ò','Ëøî‰ø°',
 'Êú¨Ê©ü','‰ªäÊó•‰ªò','Ë™ïÁîüÊó•','„Éª„Éª„ÉªÂÉï','ÂÖàÊó•','‰ªäÊúàÂàÜ','„Éª„Éª„Éª‚Ä†','ÊúàÊó•ÈáëÔΩûÊúàÊó•Êú®',
 'ÂõΩÂ§ñÂõΩ‰∫∫','üëãüòÜ‚ú®‚òÄÔ∏è\u3000Êò®Êó•','ÊÇ™Êùæ','Âπ¥ÈñìÁîü','Ë™ïÁîüÊúà‰Ωç\u3000Êúà\u3000‚ôî‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000Êúà‰Ωç\u3000ÊúàÁõ∏ÊÄß‰∏ÄË¶ßÂØæ',
 '„Éª„Éª„ÉªÈ°î','üé∂‰ªäÊó•','üíìü§ó','‰∏Ä‰∫∫Áß∞','Â≠ê‰∫∫','Â§ß‰∫∫Ê∞ó','Êó•Êú¨‰∏ÄÊòü','ÁÑ°‰∫ã','„Äú‚ô™Êú¨Êù•','‰∏ÄÁ∑í','Ê±∫ÂÆö','‰ªï‰∫ãÁµÇ','Ë≤¥Êñπ','‰∫∫ÊôÇÈñì','‰∏ÄÊ≠©','‰ªäÂæå','Êµ∑Â§ñÊó•Êú¨','ÊúÄÁµÇÊó•','Á±≥Êó•','ÔΩû¬¥‚àáÔΩÄÔæâÊ∞ó',
 '\u3000Ë¶ã','Âπ≥ÊàêÊúÄÂæå','ÂÆüË°å‰∏≠‰ªä','Êõ¥Êñ∞','ÂÖ®Âäõ','ÁµÑÈï∑','Êù•Êúà','‰ªäÊó•Âá∫Âã§','ÊòéÂæåÊó•','ÊúùÊó•','‰ΩìË™øÊÇ™','ÁîüÁâ©','Áî®‰∫ã','‰∫∫Ê∞óÈ´ò','¬¥‚àÄÔΩÄ','‰ø∫ÈÅî','Âπ¥Èñì','Êú¨Ê†º','Âπ≥Âùá','‰∏ÄÊó•Ê®™','‰ªäÊó•„É†„É™','‰ªï‰∫ã‰∏≠',
 'ÔΩû¬¥‚àáÔΩÄÔæâ\u3000ÂèØÊÑõ','Áâ©‰∫ã','Ëä±Á≤âÁóá','\u3000‰Ωï','ÂèãÈÅî','ÂßøÊó•Êú¨ÂõΩÊ∞ë','ÔΩûÔΩûüíì‚àÄ','Ë®òÂøµ','‰∫ãÂÆü','ÈÖç‰∏ãÊ∞ëÊó•Êú¨','Êó•ÊóÖ','Âà∂Èôê',
 'Â±±ÈñìÈÉ®','Â∫óÂì°','‰ªäÂõû','ÂõΩ‰ºö','ÊôÇÂÖÉÊ∞ó','ÊâãÂâç\u3000','ÊØéÊó•Ê•Ω','Ê•µ‰∏ªÂ§´ÈÅìË©±','ËªäÂá∫','‰ªäÂ§ú','Êú¨‰ºÅÁîªÊú¨ÂΩì','‰∫∫„Éª‰ªò',
 'Êº´Áîª','ÊúâÂêçÊó•Êú¨ÊñôÁêÜÂ∫ó','ÂÖÉÊ∞óÂá∫','‰∫∫ÈÅî','ÔΩû„Éì„Éº„Ç®„É´„Éà„É™„Éó„É´„Çµ„É≥„Éâ','ÔΩ∑ÔΩ¨ÔΩØ','Â±±Ë°å','ÔΩûÔΩûüíì¬¥Ëâ∏ÔΩÄ','Â§ú‰∏≠','‚ô™‰∏ªÂΩπ','Âπ¥ÂØÑ','‰∏ñÁïå','ÊÅãÊÑõ','ÊúüÈñì‰∏≠ÊØéÊó•ÂêçÊßò','ÈáéÁîü','Â∞èÂ≠¶Ê†°',
 'üíñË™ïÁîüÊó•','Â§ßÈü≥Èáè','ÁõÆÁ∑ö','ÁÅ´‰∫ã','‰∏ÄÁêÜ','„Ç∑„Ç≥„É°„É¢','‰ªïÊñπ','¬¥„Éªœâ„ÉªÔΩÄ„Ç≥„Éº„ÇØ„Ç™„É≥','ÊúÄÂº∑','Á•ûÊßò','Âá∫Êù•','Ë®òÂøµÊó•','ÈõªÊ∞ó','‰πÖ„ÄÖ','Â∞èÁîü','Êº´Áîª\u3000','‰∫åÊó•ÁõÆ',
 'Áõ∏Â§â','ÈÉ®Â±ã','Êó•ÈñìÈÄ£Á∂ö','ÈÄ£‰∏≠','ÔΩºÔΩ¥ÔæòÔΩ≤ÔΩ™ÔΩØÔΩΩÔΩºÔΩ¥ÔæòÔΩ≤ÔΩ™ÔΩØÔΩΩ','ÈõªË©±','‚Åæ‚ÅæÂ§ßÂàÜÂÖÉÊ∞ó','Áâ©ÁêÜÁöÑ','üíñ„ÄÉ','Œ£„Éª‚àÄ„Éª','Ê≠£Áõ¥ËÄÖ','‰ªäÊäï','‰ΩìËÇ≤È§®','‚ù§Ô∏èü§ó',
 'Êú™Êù•','ÁîüÊîæÈÄÅ‰∏≠','Êâã‰ºù','Áîü‰∏≠Á∂ô','ÁµÑÂΩì','Êò®Êó•ÂêåÊßò','ÊÑõËªä','‰∏≠ÂøÉ','Á¥†Êïµ','ÂõΩÈÄ£','‰ªï‰∏ä','Âêå‰∫∫Ë™å','üíï\u3000ÂèØÊÑõ','ÁîüÁî£','‰ªäÂπ¥Âàù','ÔΩû¬¥‚àáÔΩÄÔæâ\u3000Á∂æÂ§è','üëãüòÜ‚ú®‚òÄÔ∏è\u3000Áúü‰æù','‰ΩúÂìÅ','Ê¨°ÈÉé',
 'Êó•Êú¨‰∫∫ÔºÆÔΩèÁµ¶Êñô', 'ÊÅØÂ≠ê','ÔΩû‚ô™Ê∑±Â§úÈôêÂÆö‚òÖÊ¥æÁîüÔº¢Ôº¨Êùæ',
 'Êó•Êú¨Âú∞Âõ≥ÔΩû„Éû„É´„Ç≥„Éù„Éº„É≠', 'Â§ñÂá∫', 'ÂÅ•Â∫∑', 'Ê≥ïÂ≠¶ÈÉ®Áîü', 'ËÅñÊ≠å„Éà„Éâ', 'ÂõΩÊ∞ë', 'Èò™Á•ûÈõªËªä‰πóËªä‰∏≠', 'Á¨ëÁ¨ë', 'ÊØéÊó•‰∏áÂêçÊßò', 'ÊÅã‰∫∫', 'Â∞èÂ≠¶ÁîüÁî∑Â≠ê', 'Ëªä‰ª•Â§ñ', 'ÂΩìÊôÇ', 'ÂÆâÂÆö', 'ÊñáÂ≠ó‰∏≠', 'ÔΩ±ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞ÔΩ∞', 'ÊâãË°ì‰∏≠', 'ÈñãÊ•≠Âë®Âπ¥', 'ÊßòÂ≠ê', 'ÁêÜÁî±', 'Âπ≥Ê∞ó','ÂøÉÈÖç',
 'ÁîªÈù¢', 'È£üÊ¨≤', 'Êò®Êó•‰ªï‰∫ã‰ºë', 'ÁèæÂÆü', 'Ê©üÊùê', 'Â§ß‰ºö', 'Áõ∏Ë´á', 'Ë•øÊ≠¶', '‰∏ÄÈÉ®Âπ≥ÈáéÈÉ®', '‰ªäÊó•ÂΩ©Áü¢', 'Êö¥Âäõ', '‰∏ÄË¶ã', '‚ô™Ê∑±Â§úÈôêÂÆö‚òÖÊ¥æÁîüÔº¢Ôº¨Êùæ', 'Êñ∞Ëªä', 'üíì\u3000ÂáõÂ≠ê', '‰∏ÄÂ∫¶', 'ÂïèÈ°å', '„Äú‚ô™Ê∑±Â§úÈôêÂÆö‚òÖÊ¥æÁîüÔº¢Ôº¨Êùæ', 'ÈÅ†Ë∑ùÈõ¢ÊÅãÊÑõ', 'ÂêçÂâç', 'Ë∑ùÈõ¢ÊÑü', 'Â§ñÈ£üË°å', 'ÂÖÖÂÆü', 'Ê©üÂÜÖ','ÔΩûÂáõÂ≠ê',
 'Ë™ïÁîüÊó•„É≠„É¨„ÉÉ„ÇØ„Çπ', 'Á•ûÁà∂„Ç´„É©', '\u3000ÊúÄÁµÇË©±', 'Ë¶ñËÅ¥ÁéáÊó•Êú¨', 'Á∑öÈñãÊ•≠Âë®Âπ¥ÁäØ‰∫∫', 'ÂæåËÄÖ', '‰∏ÄÊ≠©Ë∏è', 'ÂíåÊ≠åÂ±±Êù•', 'ÂâçËÄÖ', 'Ôº¢Ôº¨Êùæ', 'Â≠êÈÅî', 'ÊµÅË°å', 'ÈÖç‰ø°‰∏≠Âè™‰ªä', 'Á∑èÂã¢ÂêçÊßò', '„Äú‚ô™‚ô™‚ô™„Éè„Ç°„Éè„Ç¢„Ç™„Ç´„Ç∫', 'Áô∫Ë®Ä', 'ÂÆüË°å', '‰∏Ä‰Ωì‰Ωï', 'È£ü‰∏≠ÊØíÂàÜ', 'Ê∑±Â§úÈôêÂÆö‚òÖÊ¥æÁîüÔº¢Ôº¨Êùæ', 'ÊâãÈñì', '‰∫§ÈÄöÊÉÖÂ†±„Ç¢„Éä', 'üíñ‰∏≠„ÄÖ‰ºö', 'ËªäÈ´òË™ø', '‰πóËªä','Áä¨Êßò',
 '‰ª•Ââç', '‰øÆÊÇ¶‰Ωì', 'Â•≥Â≠êÂäõÈ´ò', 'Âπ¥ÈñìÁü•', 'Âá∫Áô∫', 'Êù•Â†¥', '‰∫å‰∫∫', 'Ë°åÂãï', 'ÂíåÊ≠åÂ±±', 'ÁîüÊîæÈÄÅ', 'Êï∞ÊôÇÈñì', 'È£ü‰∫ãÂà∏ÂÜÜÂàÜ', '√óÂè∞', 'Ê≥®ÊÑè‰∏ã', '‰∏ãËªä', '‰ΩïÊïÖ', 'Âπ¥Èáë', 'Áî®ÈÄî', 'ÂõΩÂÜÖÊúâÊï∞', 'Á≤æÊ∞ó', '‰ªäÈÄ±', '‰ªäÊúù', '‰∏Ä‰∫∫ÊöÆ', 'üíñÊ∞ó','‰∫∫„ÉªÂ∏∏Ë≠ò',
 'Á≤æÁ•û', 'ÂÜÖÁî∞', 'ÈÄ±ÈñìÈôêÂÆö', '‰∏ÄÂàáÁÑ°', 'ÂÖ¨Êñá', 'È†≠Áóõ', 'Èù¢ÁôΩ', 'ÔΩûËÅ∑Â†¥', 'ÁîüÂà∂‰Ωú', 'ÂΩºÂ•≥Âá∫Êù•', 'ÔæÄÔæûÔΩß', '„ÉΩ¬¥‚àÄÔΩÄÔæâ', '\u3000Ë™∞', 'ÂÆüÈöõ', 'ÈÄöÂã§', 'üé∂‚ú®üòÜ‚ú®üé∂','‰∏á‰∫∫',
 'Èï∑Â•≥', '„ÄúÂú∞ÂÖÉÂíåÊ≠åÂ±±', '‚Åæ‚ÅæÊú™ÊàêÂπ¥', 'Êàë„ÄÖ', '‰ªä„Éà„Éâ', 'ÂßãÂãï\u3000Êñ∞Á∑öÂäõ', '‰πóÂÆ¢', 'ÊØéÊó•ÊåëÊà¶', 'ÔΩûÔΩûüíì¬¥Ëâ∏ÔΩÄÂç≥‰øùÂ≠ò', 'Âº∑Âà∂‰ΩøÁî®ÊñôÂæ¥ÂèéÊó•Êú¨', 'Â≠ê‰æõÁî®', '‚ñ≥Ê∑±Â§úÈôêÂÆö‚òÖÊ¥æÁîüÔº¢Ôº¨Êùæ', 'ÂúüÊõúÊó•‰πÖ„ÄÖ', 'Êú¨Êäú', 'ÂÜôÁúüÂá∫', '„Éï„Ç©„É≠„Éº', 'ÈÅ∏Êåô', 'ÁîüÊÅØ', '‰∫¨ÊÄ•', 'ÁïúÁîü', 'ÊÇ™Áî®', 'Â∞èË¶ãÂá∫', '‚ô™ÁæéÂë≥', 'Ëä±Á≤â', 'Ëá™‰ø°','‰∏çÊ∫Ä',
 'Âè£ÂÜÖÁÇé', '‰∏ÅÂ∫¶Âπ¥Ââç', 'ÁéãÊßò', 'Á•ûÁà∂', 'ÂÆüÊñΩ', 'Âêç‰πó', 'ÊÇ™Âæ≥‰∫∫', 'Êúà‰∏Ä„Éë„É≥„ÇØ', 'ÂØåÂ±±Â∏Ç‰∏≠Â§ÆÈÄö', 'ÂÆüË≥™ÁÑ°Êñô', 'ÊúâÂêç', 'ÊÑõÊÉÖ', 'Êù•Â†¥ËÄÖÊï∞', '\u3000Áîò', 'Ëá™Ëª¢Ëªä', 'Ê†°ÂÜÖ', 'ÂíåÊ≠åÂ±±Â∏Ç', 'ÂüºÁéâ', 'ÊôÇÊúü', '‰ªÆÈù¢„É©„Ç§„ÉÄ„Éº', 'Âπ¥ÂÖÖÈõª', '‰∏ÄË®Ä', '‰πóËªä‰∏≠„Ç≥„É°„É≥„Éà', '‚ô™ÂÉï', 'ÂÖ®ÁÑ∂', 'ÊîªÈÅîÁ£®', '‰ºäË±ÜÂ§ßÂ≥∂', 'Âú®Â∫´Êú¨', 'Á†ÇÈò≤', 'ËÇ≤ÂÖê‰∏≠', 'Ë•øÊ¥ã‰∫∫','ÊôÇ‰ª•Â§ñ„Éà„Éâ',
 'Èò™Á•û‰πó', 'Â≠ê‰æõÈÅî', 'ÁîªÂÉèÈÄÅ', 'Ë®ò‰∫ãÂÆåÊàêÂæå', 'È£ü‰∏≠ÊØíÁ∂öÂá∫‰∏≠„Ç≠„É†„ÉÅ', 'Ë•øÊ¥ãÂè§ÁâàÊó•Êú¨Âú∞Âõ≥', 'ÊÅãÊÑõÁõ∏ÊÄß', 'ÂøÖË¶Å', '‰ª•‰∏ä', 'ÂØåÂ±±ÁúåÂÜÖÊ∞óË±°ÊÉÖÂ†±', '‰ºöË®àÁÑ°Êñô', 'ÂøÉÁêÜ', 'ÂØåÂ±±ÈßÖ', '‰ªäÂæå„Çπ„Éû„Éõ', 'ÂêõÂÖÉÊ∞ó', 'ÊúâÂêçÊº´Áîª', 'Œµ¬¥‚àÄÔΩÄÔæéÔΩØ', 'ÊôÇ„ÄúÁí∞Ê∞¥ÂÖ¨ÂúíÂÜÖ', 'Èï∑Â•≥Â∞èÂ≠¶Ê†°', 'Áù°Áú†ÊôÇÈñì', 'Ë¶ãÂΩì', 'Ê©üÈï∑', 'Êñ∞ÁîüÊ¥ªÂøúÊè¥', 'Ë≠¶ÈÉ®ÁäØ‰∫∫', 'Áä∂ÊÖã', 'ËøëÈâÑÁâπÊÄ•', 'ÂêåÁ¥öÁîü','ÂÖ±Áî£ÂÖö',
 'ÂÖ¨Âúí', 'Ë°óÈ†≠ÊºîË™¨', 'ÊñáÂ≠ó', 'Êö¥Âãï‰∫ã‰ª∂', 'ÊñáÂ≠ó‰ª•‰∏ã', 'Áõ∏Êâã', '‰∏ÄÊôÇÈ†ê', '‚ô™‚ñΩ', '‰Ωç‰ø∫', 'ÂÖÉÈªíÈÉ®Â∏ÇÈï∑', '„É°„Éá„Ç£„Ç¢', '‰ΩúËÄÖ', 'Ëß£Êîæ', 'ËªäÂãùÊâã', 'Èï∑Áî∑', 'Â≠¶Ê†°', '‚ù§Ô∏é', 'ÊîøÂ∫ú', 'ÂçòË™øÊ∏õÂ∞ëÊó•Êú¨Ë™ûËÖê', '„ÄúÊôÇÈ†ÉÈ£ü', 'ÔºßÔºØ\u3000ÈõªËªä„Éª„Éê„Çπ', 'ÈÅîÊàêÊØé', 'ÔΩûÁ¨ëÈ°î', 'ÊßòÔΩÇ\u3000Ë§íÁæé', 'ÊúâÂäπÊ¥ªÁî®Âá∫Êù•', 'ÈªíÈÉ®ÂÜÜ',
 'Êù•È§®', '‰ΩìË™øËâØ', '„Äú‚ô™Áâõ‰π≥', 'Â§öÂàÜ‰ø°', 'Âä†Ë∂äËÉΩÂä†Ë≥Ä„ÉªË∂ä‰∏≠„ÉªËÉΩÁîüË≤∑', 'ÔΩû„ÇÆ„Ç∑„ÇÆ„Ç∑', 'Ê∞∑Ë¶ã', 'ÊúÄËøë', 'ÊòØÈùûÊù•', 'ÊôÇ‰ª£', 'ÂèçÊó•„É°„Éá„Ç£„Ç¢', 'ÂØåÂØåÂØå', 'Â∞éÂÖ•', 'Âèó‰ø°Êñô', '‚Äï‰∏≠ÂõΩ„É°„Éá„Ç£„Ç¢', '‰øùË≠∑ËÄÖ‰ºö', '‰∏ÅÂëÇ‰ªã', 'ÈéßÊ≠¶Â§ñ‰ºù\u3000ÂÖ¨Âºè', 'Ê≠ªÁ•û', '‚Åæ‚ÅæÊúüÂæÖ', '‰∏≠Ê≠¢', '‰∏∏‰ªäÂõû', 'ü•ñ‰ªäÂõû', '‰∫àÂÆöÈÄö', '„Äú‚ô™ÂÖ®ÁÑ∂„Ç§„Ç§', 'ËªäÂÜÖË°®Á§∫',
 'ÈñãÂÇ¨', 'Êò†Áîª', '‰∏≠Á∂ô‰ø°Âè∑', '‰ø≥‰∫∫', '‰∏äÊâã', 'ÔΩûüíïüò¥', '‰∏ÄË∂≥ÂÖà', 'Â†±ÈÅì', 'üëãüòÉ‚òÄÔ∏èÈ†ëÂºµ', 'Âà∂‰ΩúÊ±∫ÂÆö', 'Âπ¥Á¥†Êïµ', '‰ºöË©±', 'ÂØåÂ±±ÁúåÁæéË°ìÈ§®', 'ÂçíÂúíÂºèÊòéÊó•', 'Áîü‰π≥‰ΩøÁî®Áâõ‰π≥', '‰∫∫È£üÂô®Ê£ö', 'Á±≥Â≠ê', '‚Åæ‚ÅæÊöá', '‰∏ÄÂàª', 'ÈõÜÈáëÊó•Âõû„Éé„Ç§„É≠„Éº„Çº', '„Éæ‚óé¬¥‚àÄÔΩÄ‚óéÔæâ', 'ÈÄöË©±', 'ÂÑ™ÈõÖ', '‰πÖ‰øùÁî∞ÊÇ†Êù•','ÈªíÈÉ®Â∏Ç',
 'È†≠Ê∞óÊ∏©', '‰ªä„Ç∑„Éº„Ç∫„É≥', 'ÈñãÂÇ¨‰∏≠üçñ', 'È£õË°åÊ©ü', 'È£üÂô®', 'Êñ∞ÈÖí', '‰∏ãÊâã', 'Ë≤¥Êßò', '‰∏Ä‰ª∂‰ª•Êù•„É´„Éé„Éº', 'Ê∞óÂúß', '‚ô™Ôº¢Ôº¨Ôº¥„Çµ„É≥„Éâ', 'Â§ßÂàá', 'Âãø‰ΩìÁÑ°', 'ÂêçÂâçÊåô', 'ÔΩû„ÉÅ„Ç≠„É≥„Çø„ÉÑ„Çø', 'ÔΩû„Éñ„É¨„Éº„Ç≠„É≠„Éº„Çø„Éº', 'Ê¥ªÁô∫', 'Ëªä‰∏°', 'ÂêåË°å', 'Â∫óÈï∑', 'ÈáéÁêÉÈÉ®', '‰øùËÇ≤Âúí', 'Ëá™Ëª¢Ëªä‰ªò', '„Äú‚ô™„É¢„Éº„Éã„É≥„Ç∞„Çª„ÉÉ„Éà', '„ÉÑ„Ç§„Éº„Éà', 'ÊôÇÂçä', '‰ΩìÂã¢', '„ÉÜ„Ç£„ÉÉ„Ç∑„É•', 'È§ìÊ≠ªÂØ∏Ââç„ÉªÊúÄÂæå', 'ÈôêÂÆö„Éë„ÉÉ„Ç±„Éº„Ç∏', 'Âπ¥‚Äï', 'Â§¢‰∏≠', '‰ø°Âè∑ÁÑ°Ë¶ñ', 'ÂÖ¨Á¥ÑËÄÖ', 'ÔΩ•œâÔΩ•',
 'Â∫óÊù•Âßã', 'Êù•ÈÄ±', 'ÊúÄÂàù', 'ÊÅãÊÑõÁõ∏Ë´á‰πó', '‰∫∫„Éï„Ç©„É≠„Éê', 'ÂªÉ‰∫∫', 'ËÇâÈ£ü', 'Ë©¶È®ì‰∏≠', '‚ô™„ÇÆ„Ç∑„ÇÆ„Ç∑', 'ÊÑüË¨ù', 'Ê≠£Ëß£', 'Ëß£Ê±∫', 'ÈßÖÂâç', 'È´òË≤¥', '‚ô™Âäõ‰ªª', 'Âª∫Áâ©Ê≤¢Â±±', 'ÂΩºÂ•≥', '‰ΩïÂ∫¶', 'ÁÑ°Èò≤ÂÇô','Á∑öÂÖ®ÈßÖ','Âú∞ÈÖíÊ®™‰∏ÅÔΩû','ÈôêÁïå','ÁêÜÊÄßÂ§±','Âπ≥Â±±ÈÉÅÂ§´Áîª‰ºØ','ÂíåÊ≠åÂ±±„Çµ„Ç§„ÇØ„É™„É≥„Ç∞„Éï„Çß„Çπ„Çø„Ç®„Ç§„Éâ','ÂíåÊ≠åÂ±±„Çµ„Ç§„ÇØ„É™„É≥„Ç∞„Éï„Çß„Çπ„Çø','ÊôÇËµ∑','ÁÑ°Ëá™Ë¶ö','Â¶ñÁ≤æÁïå','ÁÑ°Èôê„É´„Éº„Éó','‰∏ÄÈÄî','‰∏ÄÊùØ','‰∫àÂÆö','‰ªï‰∫ãÁñ≤','Êú¨Èü≥ÊúâÁµ¶Âπ¥ÈñìÔºæœâÔºæÔΩÄÔΩ©ÔΩ§ÔΩ©ÔΩ§È®ô','ÈÅéÂéª',
 'Èñ¢ÈÄ£ÊÄß','ÊúâÊñôÈÅìË∑Ø‰Ωø','ÊúâÊ©üÊ∞¥ÈäÄ','‚Åæ‚Åæ„Çπ„ÉÜ„ÉÉ„Ç´„Éº','ÁôæÁî∞Â∞öÊ®πÊ∞èÂ§ñÂõΩ‰∫∫','ÊôÇ„ÄÖÂøò','ÈÄ£Êäï','Ëø∑Â≠ê','‰ø∫Êßò','Áü•Ë≠ò','Áæé‰πÖ','ÂõΩÊ∞ë„Ç¢„É≥„Ç±„Éº„Éà','‰∏çÊ≠£ÁïôÂ≠¶ËÄÖ',
 'ÊîøÊ≤ªÂÆ∂','ÁÑ°Êïµ','ÂÖ®ÈßÖ','Êéà‰π≥‰∏≠','ÂøÖË¶ÅÁÑ°','Á≠ãËÇâÁóõ','ÊÄßÊ†ºÂèó','ÈªíÈÉ®Â∑ù','ÈÉ®Â±ãÂåñ','Êö¥Âãï','ÁúüÂÑ™','ÈüìÂõΩ„Éä„ÉÅ„Çπ','ÈüìÂõΩÂÇæ','ÂπºÁ®öÂúíÂúüÊõúÊó•','ÊñπÊ≥ï','‰ΩìÈ®ì','Êò†ÁîªÈ§®','Âú∞ÈÖí','Ë¶ãÁõ¥',
 'Èõ∞Âõ≤Ê∞óÂá∫','‚òÖ‚òÜÁ®ΩÂè§Â†¥ÈÄö‰ø°‚ë†‚òÜ‚òÖ','ÊÉ≥ÂÉè‰ª•‰∏ä','Â§ßÂ§â','‰∏ÄÊôÇÂÅúÊ≠¢','ÊîªÊíÉË°åÂãï','ÈñãÂßã','Èï∑ÈáéÁúå','„É∂Êúà','Á≥ñÂàÜ','‚∏ùÂÖÉ„ÄÖÊòé','‰∫å‰∫∫ÊöÆ','‰ºöË®àÁµÇ','Âπ≥Âíå','ÁÑ°Èñ¢‰øÇÂÜôÁúü',
 'Èò™Á•ûË•øÂÆÆÔΩ¥ÔæãÔæûÔΩΩÔæÄË•øÂÆÆÂâç','ÈÅéÂéªÊúÄÈ´ò','„ÄúÊù°‰ª∂„Äú„ÉªÂπ≥Âùá„Ç≠„É´','Ê©üÂÜÖ„Ç¢„Éä„Ç¶„É≥„Çπ','ÂÄãÊÄß','Ê∞¥Áô∫Â£≤','„Äú‚Üí','ÈáçÂ∫¶','Á¥†Áõ¥','Â†ïÂ§©','ÊøÄÊÄí','ÊòºÈ£üÂæå','‰∫∫‰ª•‰∏äÂ∑¶Áøº','‰πÖ‰øùÁî∞ÊÇ†Êù•‰ªÆÈù¢„É©„Ç§„ÉÄ„Éº','ÊÄßÊ†ºÈáçË¶ñ','ÁóÖÊ∞ó',
 'ÂØíÊ∞ó','‰∫îÂçÉÂÜÜÔΩû','Â∞èÊ≤¢‰∏ÄÈÉéÊó©','ÁîªÂÉèÊ∑ª‰ªò','ÊúâÁµÇ','Áî∑Â•≥Â∑Æ','Â§ßÂçÉÁßãÊ•ΩÂÖ¨Êºî','‰ºöÁ§æ','Ëß£Ë™¨','Â§öÂàÜ','ÈõªË©±Ë∂ä','ÂøÉÁêÜÁöÑ','Âçò‰Ωì','ÂàùÂõûÊîæÈÄÅ','‰∏çÊ≠£','ÂõûË®Ä','Ë∑ùÈõ¢','Âèó‰ø°ÊñôÂïèÈ°å',
 'ÊúùËµ∑','Ë£èÂàá','ÂÖ•Â∫ó','Â†ÄÂÜÖÂ∫∑Áî∑Ê∞è','‰∏ÄÁï™Â•Ω','‰∏ÄË∂≥Êó©','ÊÉÖÂ†±Ëß£Á¶Å','Âê¶ÂÆö',"È†ëÂºµ","„Çπ„Éû„Éõ", "Áî∑Â≠ê", "„Éï„Ç©„É≠„Éº"]

remove_words = ["„Äú", "ÔΩó", "„Éª", "ü•∫", "‚ô°", "‚òÜ", "‚ô™", "Á¨ë", "‚Äª"]

userTweets = []


def get_userstweets(user_id, tweet_id):
    t = Twitter(auth=OAuth(
        ACCESS_TOKEN,
        ACCESS_SECRET,
        CONSUMER_KEY,
        CONSUMER_SECRET
    ))

    remain = True
    max_id = tweet_id
    remainNum = 0
    numberOfTweets = 100
    count = 50
    while remain:
        aTimeLine = t.statuses.user_timeline(user_id = user_id, count=count, max_id=max_id)
        for tweet in aTimeLine:
            userTweets.append(tweet['text'])
        max_id = aTimeLine[-1]['id']-1
        remainNum = numberOfTweets - len(userTweets)
        count = remainNum
        if len(userTweets)+1 > numberOfTweets:
            #print(userTweets)
            remain = False



@app.route('/')
def index():
    return 'Hello World!'

@app.route('/post', methods=['POST'])
def post_json():
    req_json = request.get_json()  # Get POST JSON
    key_word = req_json['key_word']

    params = {'q' : key_word, 'count' : 15}
    req = twitter.get(url, params = params)
    
    if req.status_code == 200:
        search_timeline = json.loads(req.text)
        for tweet in search_timeline['statuses']:
            user_id = tweet["user"]["id"]
            tweet_id = tweet["id"]
            get_userstweets(user_id,tweet_id)

    # Ë§áÂêàË™û„Çí„Å§„Åè„Çã
    texts = ','.join(userTweets)
    texts=re.sub(r'https?://[\w/:%#\$&\?\(\)~\.=\+\-‚Ä¶]+', "", texts)
    texts=re.sub('RT', "", texts)
    texts=re.sub('„ÅäÊ∞ó„Å´ÂÖ•„Çä', "", texts)
    texts=re.sub('„Åæ„Å®„ÇÅ', "", texts)
    texts=re.sub(r'[!-~]', "", texts)#ÂçäËßíË®òÂè∑,Êï∞Â≠ó,Ëã±Â≠ó
    texts=re.sub(r'[Ô∏∞-Ôº†]', "", texts)#ÂÖ®ËßíË®òÂè∑
    texts=re.sub('\n', "", texts)#ÊîπË°åÊñáÂ≠ó
    texts = ''.join(c for c in texts if c not in emoji.UNICODE_EMOJI) #ÁµµÊñáÂ≠ó„ÅÆÈô§Âéª
    texts = ''.join(c for c in texts if c not in remove_words) #remove_words„ÇíÈô§Âéª

    # Ë§áÂêàË™û„ÇíÊäΩÂá∫„Åó„ÄÅÈáçË¶ÅÂ∫¶„ÇíÁÆóÂá∫
    frequency = japanese_plaintext.cmp_noun_dict(texts)
    LR = core.score_lr(frequency,
            ignore_words=japanese_plaintext.IGNORE_WORDS,
            lr_mode=1, average_rate=0.1
        )
    term_imp = core.term_importance(frequency, LR)

    # ÈáçË¶ÅÂ∫¶„ÅåÈ´ò„ÅÑÈ†Ü„Å´‰∏¶„ÅπÊõø„Åà„Å¶Âá∫Âäõ
    important_words = []
    important_score = []
    data_collection = collections.Counter(term_imp)
    for cmp_noun, value in data_collection.most_common():
        if value > 10000000:
            if core.modify_agglutinative_lang(cmp_noun) in ignore_words:
                continue
            else:
                important_words.append(core.modify_agglutinative_lang(cmp_noun))
                important_score.append(value)
                
    #jsonÂΩ¢ÂºèÂåñ„Åó„Å¶Âá∫Âäõ
    # ys = cl.OrderedDict()
    ys = {}
    for i in range(500):
        #data = cl.OrderedDict()
        data = {}
        data["ID"] = i
        data["importance"] = important_score[i]
        ys[important_words[i]] = data

    result_json = json.dumps(ys, ensure_ascii=False, indent=4)
    return result_json


if __name__ == "__main__":
    run(host="0.0.0.0", port=int(os.environ.get("PORT", 5000)))
